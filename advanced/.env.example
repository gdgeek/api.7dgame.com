# =============================================================================
# Application Environment Configuration
# =============================================================================

# Application Environment (development, staging, production)
APP_ENV=development
APP_DEBUG=true

# =============================================================================
# Swagger API Documentation Configuration
# =============================================================================

SWAGGER_USERNAME=swagger_admin
SWAGGER_PASSWORD=YourStrongP@ssw0rd!
SWAGGER_ENABLED=true

# =============================================================================
# Database Configuration
# =============================================================================

DB_HOST=localhost
DB_PORT=3306
DB_NAME=yii2advanced
DB_USERNAME=root
DB_PASSWORD=

# =============================================================================
# JWT (JSON Web Token) Configuration
# Requirement 3.1: Cryptographically secure secret key of at least 256 bits
# =============================================================================

# JWT secret key - MUST be at least 32 characters (256 bits) for HS256
# Generate with: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-key-at-least-32-chars
JWT_ISSUER=yii2-app
JWT_ACCESS_TOKEN_EXPIRY=3600
JWT_REFRESH_TOKEN_EXPIRY=604800

# For key rotation - set the previous secret when rotating keys
JWT_PREVIOUS_SECRET=
JWT_KEY_ROTATION_GRACE_PERIOD=86400

# =============================================================================
# Redis Configuration
# Used for rate limiting and token revocation
# Requirements: 4.1, 8.4
# =============================================================================

REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_SECURITY_DB=1
REDIS_TIMEOUT=2.5
REDIS_KEY_PREFIX=security:
REDIS_ENABLE_RATE_LIMIT=true
REDIS_ENABLE_TOKEN_REVOCATION=true

# =============================================================================
# Rate Limiting Configuration
# Requirement 4.1: 100 requests per minute per IP
# Requirement 4.2: 1000 requests per hour per user
# =============================================================================

RATE_LIMIT_ENABLED=true
RATE_LIMIT_IP_PER_MINUTE=100
RATE_LIMIT_USER_PER_HOUR=1000
RATE_LIMIT_LOGIN_ATTEMPTS=5
RATE_LIMIT_LOGIN_WINDOW=15

# =============================================================================
# Password Policy Configuration
# Requirements: 5.1, 5.2, 5.3, 5.4
# =============================================================================

PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGIT=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_HISTORY_COUNT=5
PASSWORD_ADMIN_EXPIRY_DAYS=90
PASSWORD_BCRYPT_COST=12

# =============================================================================
# Account Lockout Configuration
# Requirement 3.8: Lockout after 5 failed attempts within 15 minutes
# =============================================================================

ACCOUNT_LOCKOUT_THRESHOLD=5
ACCOUNT_LOCKOUT_DURATION=30
ACCOUNT_LOCKOUT_WINDOW=15

# =============================================================================
# Session Configuration
# Requirement 8.6: 30 minutes inactivity timeout
# =============================================================================

SESSION_TIMEOUT_MINUTES=30
SESSION_REGENERATE_ON_AUTH=true

# =============================================================================
# File Upload Configuration
# Requirement 2.3: Maximum 10MB file size
# =============================================================================

UPLOAD_MAX_FILE_SIZE=10485760
UPLOAD_PATH=/var/uploads

# =============================================================================
# CORS Configuration
# Requirements: 4.4, 4.5
# =============================================================================

# Comma-separated list of allowed origins (no wildcards in production!)
CORS_ALLOWED_ORIGINS=https://example.com,https://app.example.com
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=3600

# =============================================================================
# Audit Logging Configuration
# Requirements: 9.4, 9.5
# =============================================================================

AUDIT_ENABLED=true
AUDIT_RETENTION_DAYS=90
AUDIT_LOG_PATH=@runtime/logs/security

# =============================================================================
# Error Handling Configuration
# Requirements: 9.1, 9.3
# =============================================================================

SHOW_DETAILED_ERRORS=false
ALERT_ON_CRITICAL_ERRORS=true
ALERT_EMAILS=admin@example.com
