# 腾讯企业邮箱 SMTP 授权码获取指南

## 🔐 为什么需要授权码？

腾讯企业邮箱为了安全，不允许直接使用邮箱密码进行 SMTP 认证，需要生成专门的**授权码**。

## 📝 获取步骤

### 1. 登录企业邮箱
- 访问：https://exmail.qq.com
- 使用邮箱账号登录：`dev@bujiaban.com`
- 输入邮箱密码

### 2. 进入设置页面
- 登录后，点击页面右上角的 **设置** 图标（齿轮图标）
- 选择 **账户** 或 **账号设置**

### 3. 开启 SMTP 服务
- 在设置页面中找到 **POP3/IMAP/SMTP/Exchange服务设置**
- 或者找到 **客户端设置** 选项
- 确保 **SMTP 服务** 已开启（打勾）

### 4. 生成授权码
- 在 SMTP 服务设置区域，找到 **生成授权码** 按钮
- 点击后会要求进行身份验证（通常是手机验证码）
- 输入收到的验证码
- 系统会生成一个 **16 位授权码**（类似：`abcd1234efgh5678`）
- **重要**：立即复制并保存这个授权码，关闭窗口后无法再次查看

### 5. 更新配置文件

编辑 `.env.docker` 文件：

```bash
# 将密码替换为刚才生成的授权码
MAILER_USERNAME=dev@bujiaban.com
MAILER_PASSWORD=你刚才生成的16位授权码
```

### 6. 重启服务

```bash
docker-compose restart api
```

### 7. 测试邮件发送

```bash
docker-compose exec api php yii test-email/send nethz@163.com
```

## 🔧 SMTP 配置信息

当前配置使用：
- **SMTP 服务器**: smtp.exmail.qq.com
- **端口**: 25（自动 TLS）
- **加密方式**: 自动检测
- **认证方式**: LOGIN
- **账号**: dev@bujiaban.com
- **密码**: 需要使用授权码（不是邮箱密码）

## ⚠️ 注意事项

1. **授权码不是邮箱密码** - 必须使用生成的授权码
2. **授权码只显示一次** - 生成后立即保存
3. **可以重新生成** - 如果忘记了，可以重新生成新的授权码
4. **一个账号可以有多个授权码** - 用于不同的应用
5. **授权码可以删除** - 在设置页面可以管理和删除授权码

## 🔍 常见问题

### Q: 找不到生成授权码的选项？
A: 确保你登录的是企业邮箱管理员账号，或者该账号有权限开启 SMTP 服务。

### Q: 生成授权码时提示需要验证？
A: 这是安全措施，需要通过手机验证码或其他方式验证身份。

### Q: 授权码忘记了怎么办？
A: 可以重新生成新的授权码，旧的授权码会失效。

### Q: 使用授权码后还是认证失败？
A: 检查以下几点：
- 确认授权码复制完整（16位）
- 确认没有多余的空格
- 确认 SMTP 服务已开启
- 尝试重新生成授权码

## 📞 需要帮助？

如果遇到问题：
1. 检查企业邮箱管理后台的 SMTP 设置
2. 确认账号有权限使用 SMTP 服务
3. 联系企业邮箱管理员
4. 查看腾讯企业邮箱帮助文档：https://work.weixin.qq.com/help

---

**获取授权码后，请更新 `.env.docker` 文件并重启服务！**
